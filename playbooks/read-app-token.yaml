-
  name: Read a token using regular expression
  hosts: webserver
  tasks:
    - name: Copy File to the target system
      copy:
        src: /ansible-inventory-check/playbooks/purchaseOrder.xml
        dest: $HOME/app/conf/purchaseOrder.xml

    - name: importing the file contents to variable
      slurp:
        src: $HOME/app/conf/purchaseOrder.xml
      register: idb_endpoint_b64

    - name: Decoding the content from base 64 to normal text
      set_fact:
        idb_endpoint: "{{ idb_endpoint_b64.content | b64decode }}"

    - debug:
        var: idb_endpoint

    - shell: echo 'vault-option name="@KEYSTORE_PASSWORD@" value="@MASK-5dOaAVafCSd@" value="@One more time@" value="@MASK-ED-123-LT@"'
      register: results

    - debug:
        var: results

    - set_fact:
        myvalue: "{{ idb_endpoint | regex_findall(regexp)}}"
      vars:
        regexp: '(?<=\@)(.*?)(?=\@)'

    - debug:
        var: myvalue


